{"version":3,"sources":["webpack://ringcentral-engage-voice-embeddable-mobile/./node_modules/@babel/runtime/helpers/defineProperty.js","webpack://ringcentral-engage-voice-embeddable-mobile/webpack/bootstrap","webpack://ringcentral-engage-voice-embeddable-mobile/webpack/runtime/compat get default export","webpack://ringcentral-engage-voice-embeddable-mobile/webpack/runtime/define property getters","webpack://ringcentral-engage-voice-embeddable-mobile/webpack/runtime/hasOwnProperty shorthand","webpack://ringcentral-engage-voice-embeddable-mobile/./src/client/app/common.js","webpack://ringcentral-engage-voice-embeddable-mobile/./src/client/app/check-permission.js","webpack://ringcentral-engage-voice-embeddable-mobile/./src/client/app/event-handler.js","webpack://ringcentral-engage-voice-embeddable-mobile/./src/client/work.js"],"names":["_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","module","exports","wait","ms","Promise","resolve","setTimeout","waitUntilLoad","inited","window","cordova","plugins","iosrtc","console","log","loadScript","url","script","document","createElement","type","src","async","body","appendChild","checkPermission","registerGlobals","navigator","mediaDevices","enumerateDevices","enumerateDevicesOriginal","keys","then","arr","map","d","reduce","p","k","audioinput","checkMicrophonePermission","hasPermission","getMicrophonePermission","message","warn","postMessage","data","getCode","c","localStorage","getItem","setItem","login","callbackUri","rc","getUrl","authUrlDefaultRc","replace","defaultState","view","onEvent","e","debug","oAuthUri","location","href","handleEvent","JSON","parse","stringify","addEventListener","run"],"mappings":"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","file":"js/work.bundle.js","sourcesContent":["function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => module['default'] :\n\t\t() => module;\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)","\nexport function wait (ms) {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms)\n  })\n}\n\nexport async function waitUntilLoad () {\n  let inited = false\n  while (!inited) {\n    if (window.cordova && window.cordova.plugins && window.cordova.plugins.iosrtc) {\n      inited = true\n    } else {\n      console.log('wait')\n      await wait(50)\n    }\n  }\n  return true\n}\n\nexport function loadScript (url) {\n  const script = document.createElement('script')\n  script.type = 'text/javascript'\n  script.src = 'app.js'\n  script.async = false\n  document.body.appendChild(script)\n}\n","\nexport function checkPermission () {\n  // First check whether we already have permission to access the microphone.\n  cordova.plugins.iosrtc.registerGlobals()\n  if (navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {\n    navigator.mediaDevices.enumerateDevicesOriginal = navigator.mediaDevices.enumerateDevices\n    navigator.mediaDevices.enumerateDevices = () => {\n      const keys = [\n        'deviceId',\n        'facing',\n        'groupId',\n        'id',\n        'kind',\n        'label'\n      ]\n      return navigator\n        .mediaDevices\n        .enumerateDevicesOriginal()\n        .then(arr => {\n          return arr.map(d => {\n            return keys.reduce((p, k) => {\n              return {\n                ...p,\n                [k]: d[k] || ''\n              }\n            }, {})\n          })\n        })\n    }\n  }\n  window.audioinput.checkMicrophonePermission((hasPermission) => {\n    if (hasPermission) {\n      console.log('We already have permission to record.')\n      // startCapture()\n    } else {\n      // Ask the user for permission to access the microphone\n      window.audioinput.getMicrophonePermission((hasPermission, message) => {\n        if (hasPermission) {\n          console.log('User granted us permission to record.')\n        } else {\n          console.warn('User denied permission to record.')\n        }\n      })\n    }\n  })\n}\n","/**\n * handle events\n */\n\nfunction postMessage (data) {\n  window.postMessage(data, '*')\n}\n\nfunction getCode () {\n  const key = 'rc-authcode'\n  const c = window.localStorage.getItem(key)\n  if (c) {\n    window.localStorage.setItem(key, '')\n    return c\n  } else {\n    return ''\n  }\n}\n\nfunction login () {\n  const c = getCode()\n  if (c) {\n    postMessage({\n      type: 'rc-ev-authorization-code',\n      callbackUri: `${window.rc.callbackUri}?code=${c}`\n    })\n  }\n}\n\nfunction getUrl () {\n  return window.rc.authUrlDefaultRc.replace(\n    window.rc.defaultState,\n    window.rc.view\n  )\n}\n\nfunction onEvent (e) {\n  const { data } = e\n  console.debug('got data from ev', data)\n  if (data) {\n    switch (data.type) {\n      case 'rc-ev-loginPopup':\n        // get login oAuthUri from widget\n        console.log('rc-ev-loginPopup:', data.oAuthUri)\n        window.location.href = getUrl()\n        //  window.open(data.oAuthUri); // open oauth uri to login\n        break\n      case 'rc-ev-init':\n        login()\n        postMessage({\n          type: 'rc-init-rtc'\n        })\n        break\n      default:\n        break\n    }\n  }\n}\n\nexport function handleEvent () {\n  window.rc = JSON.parse(\n    window.localStorage.getItem('rc-data-ref', JSON.stringify(window.rc))\n  )\n  // window.top = window\n  // window.parent = window\n  window.addEventListener('message', onEvent)\n}\n","\n/**\n * replace app default script\n */\n\nimport { waitUntilLoad, loadScript } from './app/common'\nimport { checkPermission } from './app/check-permission'\nimport { handleEvent } from './app/event-handler'\n\nasync function run () {\n  await waitUntilLoad()\n  checkPermission()\n  loadScript('app.js')\n  handleEvent()\n}\n\nrun()\n"],"sourceRoot":""}