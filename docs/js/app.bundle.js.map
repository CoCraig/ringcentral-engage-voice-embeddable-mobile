{"version":3,"sources":["webpack://ringcentral-engage-voice-embeddable-mobile/./node_modules/@babel/runtime/helpers/defineProperty.js","webpack://ringcentral-engage-voice-embeddable-mobile/webpack/bootstrap","webpack://ringcentral-engage-voice-embeddable-mobile/webpack/runtime/compat get default export","webpack://ringcentral-engage-voice-embeddable-mobile/webpack/runtime/define property getters","webpack://ringcentral-engage-voice-embeddable-mobile/webpack/runtime/hasOwnProperty shorthand","webpack://ringcentral-engage-voice-embeddable-mobile/external \"React\"","webpack://ringcentral-engage-voice-embeddable-mobile/external \"ReactDOM\"","webpack://ringcentral-engage-voice-embeddable-mobile/./src/client/components/index/index.jsx","webpack://ringcentral-engage-voice-embeddable-mobile/./src/client/app.js"],"names":["_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","module","exports","App","Component","loggedIn","fetchingUser","loginning","window","rc","isIOS","c","localStorage","getItem","setItem","data","document","querySelector","contentWindow","postMessage","getCode","type","callbackUri","permissions","cordova","plugins","list","CAPTURE_AUDIO_OUTPUT","RECORD_AUDIO","checkPermission","status","console","log","hasPermission","requestPermissions","e","open","InAppBrowser","addEventListener","onEvent","debug","oAuthUri","location","href","getUrl","login","authUrlDefaultRc","replace","defaultState","view","componentDidMount","initEvent","requirePermissions","render","url","server","appConfigQuery","renderReactDom","ReactDOM","getElementById"],"mappings":";;;;;;AAAA,SAASA,eAAT,CAAyBC,GAAzB,EAA8BC,GAA9B,EAAmCC,KAAnC,EAA0C;AACxC,MAAID,GAAG,IAAID,GAAX,EAAgB;AACdG,UAAM,CAACC,cAAP,CAAsBJ,GAAtB,EAA2BC,GAA3B,EAAgC;AAC9BC,WAAK,EAAEA,KADuB;AAE9BG,gBAAU,EAAE,IAFkB;AAG9BC,kBAAY,EAAE,IAHgB;AAI9BC,cAAQ,EAAE;AAJoB,KAAhC;AAMD,GAPD,MAOO;AACLP,OAAG,CAACC,GAAD,CAAH,GAAWC,KAAX;AACD;;AAED,SAAOF,GAAP;AACD;;AAEDQ,MAAM,CAACC,OAAP,GAAiBV,eAAjB,C;;;;;;UCfA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCrBA;WACA;WACA;WACA;WACA;WACA,gCAAgC,YAAY;WAC5C;WACA,E;;;;;WCPA;WACA;WACA;WACA;WACA,wCAAwC,yCAAyC;WACjF;WACA;WACA,E;;;;;WCPA,sF;;;;;;;;ACAA,MAAM,8BAA4B,S;;;ACAlC,MAAM,iCAA4B,Y;;;;;;;ACAlC;AAEe,MAAMW,GAAN,SAAkBC,wCAAlB,CAA4B;AAAA;AAAA;;AAAA,4CACjC;AACNC,cAAQ,EAAE,KADJ;AAENC,kBAAY,EAAE,KAFR;AAGNC,eAAS,EAAE;AAHL,KADiC;;AAAA,4CAOjCC,MAAM,CAACC,EAAP,CAAUC,KAPuB;;AAAA,8CAiB/B,MAAM;AACd,YAAMhB,GAAG,GAAG,aAAZ;AACA,YAAMiB,CAAC,GAAGH,MAAM,CAACI,YAAP,CAAoBC,OAApB,CAA4BnB,GAA5B,CAAV;;AACA,UAAIiB,CAAJ,EAAO;AACLH,cAAM,CAACI,YAAP,CAAoBE,OAApB,CAA4BpB,GAA5B,EAAiC,EAAjC;AACA,eAAOiB,CAAP;AACD,OAHD,MAGO;AACL,eAAO,EAAP;AACD;AACF,KA1BwC;;AAAA,kDA4B1BI,IAAD,IAAU;AACtBC,cAAQ,CAACC,aAAT,CAAuB,0BAAvB,EAAmDC,aAAnD,CAAiEC,WAAjE,CAA6EJ,IAA7E,EAAmF,GAAnF;AACD,KA9BwC;;AAAA,4CAgCjC,MAAM;AACZ,YAAMJ,CAAC,GAAG,KAAKS,OAAL,EAAV;;AACA,UAAIT,CAAJ,EAAO;AACL,aAAKQ,WAAL,CAAiB;AACfE,cAAI,EAAE,0BADS;AAEfC,qBAAW,EAAG,GAAEd,MAAM,CAACC,EAAP,CAAUa,WAAY,SAAQX,CAAE;AAFjC,SAAjB;AAID;AACF,KAxCwC;;AAAA,yDA0CpB,MAAM;AACzB,UAAI;AACF,cAAM;AAAEY;AAAF,YAAkBC,OAAO,CAACC,OAAhC;AACA,cAAMC,IAAI,GAAG,CACXH,WAAW,CAACI,oBADD,EAEXJ,WAAW,CAACK,YAFD,CAAb;AAIAL,mBAAW,CAACM,eAAZ,CAA4BH,IAA5B,EAAmCI,MAAD,IAAY;AAC5CC,iBAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BF,MAA/B;;AACA,cAAI,CAACA,MAAM,CAACG,aAAZ,EAA2B;AACzBV,uBAAW,CAACW,kBAAZ,CACER,IADF,EAEGI,MAAD,IAAY;AACV,kBAAI,CAACA,MAAM,CAACG,aAAZ,EAA2B;AACzBF,uBAAO,CAACC,GAAR,CAAY,uBAAZ;AACD;AACF,aANH,EAOED,OAAO,CAACC,GAPV;AASD;AACF,SAbD,EAaG,IAbH;AAcD,OApBD,CAoBE,OAAOG,CAAP,EAAU;AACVJ,eAAO,CAACC,GAAR,CAAYG,CAAZ;AACD;AACF,KAlEwC;;AAAA,gDAoE7B,MAAM;AAChB,UAAI,OAAOX,OAAP,KAAmB,WAAvB,EAAoC;AAClChB,cAAM,CAAC4B,IAAP,GAAcZ,OAAO,CAACa,YAAR,CAAqBD,IAAnC;AACD;;AACD5B,YAAM,CAAC8B,gBAAP,CAAwB,SAAxB,EAAmC,KAAKC,OAAxC;AACD,KAzEwC;;AAAA,8CA2E/BJ,CAAC,IAAI;AACb,YAAM;AAAEpB;AAAF,UAAWoB,CAAjB;AACAJ,aAAO,CAACS,KAAR,CAAc,kBAAd,EAAkCzB,IAAlC;;AACA,UAAIA,IAAJ,EAAU;AACR,gBAAQA,IAAI,CAACM,IAAb;AACE,eAAK,kBAAL;AACE;AACAU,mBAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiCjB,IAAI,CAAC0B,QAAtC;AACAjC,kBAAM,CAACkC,QAAP,CAAgBC,IAAhB,GAAuB,KAAKC,MAAL,EAAvB,CAHF,CAIE;;AACA;;AACF,eAAK,YAAL;AACE,iBAAKC,KAAL;AACA,iBAAK1B,WAAL,CAAiB;AACfE,kBAAI,EAAE;AADS,aAAjB;AAGA;;AACF;AACE;AAdJ;AAgBD;AACF,KAhGwC;;AAAA,6CAkGhC,MAAM;AACb,aAAOb,MAAM,CAACC,EAAP,CAAUqC,gBAAV,CAA2BC,OAA3B,CAAmCvC,MAAM,CAACC,EAAP,CAAUuC,YAA7C,EAA2DxC,MAAM,CAACC,EAAP,CAAUwC,IAArE,CAAP;AACD,KApGwC;AAAA;;AASzCC,mBAAiB,GAAI;AACnBnB,WAAO,CAACC,GAAR,CAAY,OAAZ,EAAqB,KAAKtB,KAA1B;AACA,SAAKyC,SAAL;;AACA,QAAI,CAAC,KAAKzC,KAAV,EAAiB;AACf,WAAK0C,kBAAL;AACD;AACF;;AAuFDC,QAAM,GAAI;AACR,UAAMC,GAAG,GAAG,KAAK5C,KAAL,GACRF,MAAM,CAACC,EAAP,CAAU8C,MAAV,GAAmB,sBAAnB,GAA4C/C,MAAM,CAACC,EAAP,CAAU+C,cAD9C,GAER,mEAAmEhD,MAAM,CAACC,EAAP,CAAU+C,cAFjF;AAGA,wBACE;AAAK,QAAE,EAAC;AAAR,oBACE;AACE,QAAE,EAAC,yBADL;AAEE,SAAG,EAAEF,GAFP;AAGE,aAAO,EAAC,0DAHV;AAIE,WAAK,EAAC;AAJR,MADF,CADF;AAUD;;AApHwC,C;;ACF3C;AACA;AACA;AAEA;AACA;AACA;AACA;;AAEA,MAAMG,cAAc,GAAG,MAAM;AAC3BC,oCAAA,eAAgB,uCAAC,GAAD,OAAhB,EAAyB1C,QAAQ,CAAC2C,cAAT,CAAwB,WAAxB,CAAzB;AACD,CAFD;;AAIA,IAAInD,MAAM,CAACgB,OAAX,EAAoB;AAClBR,UAAQ,CAACsB,gBAAT,CAA0B,aAA1B,EAAyC,MAAM;AAC7CmB,kBAAc;AACf,GAFD,EAEG,KAFH;AAGD,CAJD,MAIO;AACLA,gBAAc;AACf,C","file":"js/app.bundle.js","sourcesContent":["function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => module['default'] :\n\t\t() => module;\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)","const __WEBPACK_NAMESPACE_OBJECT__ = React;","const __WEBPACK_NAMESPACE_OBJECT__ = ReactDOM;","import { Component } from 'react'\n\nexport default class App extends Component {\n  state = {\n    loggedIn: false,\n    fetchingUser: false,\n    loginning: false\n  }\n\n  isIOS = window.rc.isIOS\n\n  componentDidMount () {\n    console.log('isios', this.isIOS)\n    this.initEvent()\n    if (!this.isIOS) {\n      this.requirePermissions()\n    }\n  }\n\n  getCode = () => {\n    const key = 'rc-authcode'\n    const c = window.localStorage.getItem(key)\n    if (c) {\n      window.localStorage.setItem(key, '')\n      return c\n    } else {\n      return ''\n    }\n  }\n\n  postMessage = (data) => {\n    document.querySelector('#rc-widget-adapter-frame').contentWindow.postMessage(data, '*')\n  }\n\n  login = () => {\n    const c = this.getCode()\n    if (c) {\n      this.postMessage({\n        type: 'rc-ev-authorization-code',\n        callbackUri: `${window.rc.callbackUri}?code=${c}`\n      })\n    }\n  }\n\n  requirePermissions = () => {\n    try {\n      const { permissions } = cordova.plugins\n      const list = [\n        permissions.CAPTURE_AUDIO_OUTPUT,\n        permissions.RECORD_AUDIO\n      ]\n      permissions.checkPermission(list, (status) => {\n        console.log('permission list', status)\n        if (!status.hasPermission) {\n          permissions.requestPermissions(\n            list,\n            (status) => {\n              if (!status.hasPermission) {\n                console.log('set permission failed')\n              }\n            },\n            console.log\n          )\n        }\n      }, null)\n    } catch (e) {\n      console.log(e)\n    }\n  }\n\n  initEvent = () => {\n    if (typeof cordova !== 'undefined') {\n      window.open = cordova.InAppBrowser.open\n    }\n    window.addEventListener('message', this.onEvent)\n  }\n\n  onEvent = e => {\n    const { data } = e\n    console.debug('got data from ev', data)\n    if (data) {\n      switch (data.type) {\n        case 'rc-ev-loginPopup':\n          // get login oAuthUri from widget\n          console.log('rc-ev-loginPopup:', data.oAuthUri)\n          window.location.href = this.getUrl()\n          //  window.open(data.oAuthUri); // open oauth uri to login\n          break\n        case 'rc-ev-init':\n          this.login()\n          this.postMessage({\n            type: 'rc-init-rtc'\n          })\n          break\n        default:\n          break\n      }\n    }\n  }\n\n  getUrl = () => {\n    return window.rc.authUrlDefaultRc.replace(window.rc.defaultState, window.rc.view)\n  }\n\n  render () {\n    const url = this.isIOS\n      ? window.rc.server + '/embeddable/app.html' + window.rc.appConfigQuery\n      : 'https://ringcentral.github.io/engage-voice-embeddable/app.html' + window.rc.appConfigQuery\n    return (\n      <div id='app'>\n        <iframe\n          id='rc-widget-adapter-frame'\n          src={url}\n          sandbox='allow-same-origin allow-scripts allow-forms allow-popups'\n          allow='microphone'\n        />\n      </div>\n    )\n  }\n}\n","/**\n * entry file for install page\n */\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './components/index/index.jsx'\nimport './css/index.styl'\n\nconst renderReactDom = () => {\n  ReactDOM.render(<App />, document.getElementById('container'))\n}\n\nif (window.cordova) {\n  document.addEventListener('deviceready', () => {\n    renderReactDom()\n  }, false)\n} else {\n  renderReactDom()\n}\n"],"sourceRoot":""}