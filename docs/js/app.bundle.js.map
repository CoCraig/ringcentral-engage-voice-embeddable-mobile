{"version":3,"sources":["webpack://ringcentral-engage-voice-embeddable-mobile/./node_modules/@babel/runtime/helpers/defineProperty.js","webpack://ringcentral-engage-voice-embeddable-mobile/webpack/bootstrap","webpack://ringcentral-engage-voice-embeddable-mobile/webpack/runtime/compat get default export","webpack://ringcentral-engage-voice-embeddable-mobile/webpack/runtime/define property getters","webpack://ringcentral-engage-voice-embeddable-mobile/webpack/runtime/hasOwnProperty shorthand","webpack://ringcentral-engage-voice-embeddable-mobile/external \"React\"","webpack://ringcentral-engage-voice-embeddable-mobile/external \"ReactDOM\"","webpack://ringcentral-engage-voice-embeddable-mobile/./src/client/app/common.js","webpack://ringcentral-engage-voice-embeddable-mobile/./src/client/components/index/index.jsx","webpack://ringcentral-engage-voice-embeddable-mobile/./src/client/app.js"],"names":["_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","module","exports","wait","ms","Promise","resolve","setTimeout","waitUntilLoad","inited","window","cordova","plugins","iosrtc","console","log","loadScript","url","script","document","createElement","type","src","async","body","appendChild","App","Component","loggedIn","fetchingUser","loginning","rc","isIOS","permissions","c","localStorage","getItem","setItem","data","querySelector","contentWindow","postMessage","getCode","callbackUri","list","CAPTURE_AUDIO_OUTPUT","RECORD_AUDIO","checkPermission","status","hasPermission","requestPermissions","e","open","InAppBrowser","addEventListener","onEvent","debug","oAuthUri","location","href","getUrl","login","authUrlDefaultRc","replace","defaultState","view","componentDidMount","initEvent","requirePermissions","render","server","appConfigQuery","renderReactDom","ReactDOM","getElementById"],"mappings":"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","file":"js/app.bundle.js","sourcesContent":["function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => module['default'] :\n\t\t() => module;\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)","const __WEBPACK_NAMESPACE_OBJECT__ = React;","const __WEBPACK_NAMESPACE_OBJECT__ = ReactDOM;","\nexport function wait (ms) {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms)\n  })\n}\n\nexport async function waitUntilLoad () {\n  let inited = false\n  while (!inited) {\n    if (window.cordova && window.cordova.plugins && window.cordova.plugins.iosrtc) {\n      inited = true\n    } else {\n      console.log('wait')\n      await wait(50)\n    }\n  }\n  return true\n}\n\nexport function loadScript (url) {\n  const script = document.createElement('script')\n  script.type = 'text/javascript'\n  script.src = 'app.js'\n  script.async = false\n  document.body.appendChild(script)\n}\n","import { Component } from 'react'\nimport { wait } from '../../app/common'\n\nexport default class App extends Component {\n  state = {\n    loggedIn: false,\n    fetchingUser: false,\n    loginning: false\n  }\n\n  isIOS = window.rc.isIOS\n\n  componentDidMount () {\n    console.log('isios', this.isIOS)\n    this.initEvent()\n    if (!this.isIOS) {\n      this.requirePermissions()\n    }\n  }\n\n  waitUntilLoad = async () => {\n    let inited = false\n    while (!inited) {\n      if (window.cordova && window.cordova.plugins && window.cordova.plugins.permissions) {\n        inited = true\n      } else {\n        await wait(50)\n      }\n    }\n    return true\n  }\n\n  getCode = () => {\n    const key = 'rc-authcode'\n    const c = window.localStorage.getItem(key)\n    if (c) {\n      window.localStorage.setItem(key, '')\n      return c\n    } else {\n      return ''\n    }\n  }\n\n  postMessage = (data) => {\n    document.querySelector('#rc-widget-adapter-frame').contentWindow.postMessage(data, '*')\n  }\n\n  login = () => {\n    const c = this.getCode()\n    if (c) {\n      this.postMessage({\n        type: 'rc-ev-authorization-code',\n        callbackUri: `${window.rc.callbackUri}?code=${c}`\n      })\n    }\n  }\n\n  requirePermissions = async () => {\n    await this.waitUntilLoad()\n    try {\n      const { permissions } = cordova.plugins\n      const list = [\n        permissions.CAPTURE_AUDIO_OUTPUT,\n        permissions.RECORD_AUDIO\n      ]\n      permissions.checkPermission(list, (status) => {\n        console.log('permission list', status)\n        if (!status.hasPermission) {\n          permissions.requestPermissions(\n            list,\n            (status) => {\n              if (!status.hasPermission) {\n                console.log('set permission failed')\n              }\n            },\n            console.log\n          )\n        }\n      }, null)\n    } catch (e) {\n      console.log(e)\n    }\n  }\n\n  initEvent = () => {\n    if (typeof cordova !== 'undefined') {\n      window.open = cordova.InAppBrowser.open\n    }\n    window.addEventListener('message', this.onEvent)\n  }\n\n  onEvent = e => {\n    const { data } = e\n    console.debug('got data from ev', data)\n    if (data) {\n      switch (data.type) {\n        case 'rc-ev-loginPopup':\n          // get login oAuthUri from widget\n          console.log('rc-ev-loginPopup:', data.oAuthUri)\n          window.location.href = this.getUrl()\n          //  window.open(data.oAuthUri); // open oauth uri to login\n          break\n        case 'rc-ev-init':\n          this.login()\n          this.postMessage({\n            type: 'rc-init-rtc'\n          })\n          break\n        default:\n          break\n      }\n    }\n  }\n\n  getUrl = () => {\n    return window.rc.authUrlDefaultRc.replace(window.rc.defaultState, window.rc.view)\n  }\n\n  render () {\n    const url = this.isIOS\n      ? window.rc.server + '/embeddable/app.html' + window.rc.appConfigQuery\n      : 'https://ringcentral.github.io/engage-voice-embeddable/app.html' + window.rc.appConfigQuery\n    return (\n      <div id='app'>\n        <iframe\n          id='rc-widget-adapter-frame'\n          src={url}\n          sandbox='allow-same-origin allow-scripts allow-forms allow-popups'\n          allow='microphone'\n        />\n      </div>\n    )\n  }\n}\n","/**\n * entry file for install page\n */\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './components/index/index.jsx'\nimport './css/index.styl'\n\nconst renderReactDom = () => {\n  ReactDOM.render(<App />, document.getElementById('container'))\n}\n\nif (window.cordova) {\n  document.addEventListener('deviceready', () => {\n    renderReactDom()\n  }, false)\n} else {\n  renderReactDom()\n}\n"],"sourceRoot":""}